{% extends 'trackingtalibe/base.html' %}
{% block title %}Liste des enfants{% endblock %}
{% block content %}
<div class="container-fluid px-3" style="margin-top: 60px;">
  <div class="row">
    <div class="col-12 col-lg-10 offset-lg-1">

      <h2 class="text-center">Espace de gestion - Daara {{ user.nom_daara }}</h2>
      <h6 class="text-center">Bienvenue sur l'espace dédié à la gestion de vos talibés.</h6>

      <div class="d-flex flex-wrap gap-2 my-3">
        <a href="{% url 'ajouter_enfant' %}" class="btn btn-success">Ajouter un talibé</a>
        <a href="{% url 'gestion_associations' %}" class="btn btn-outline-primary">Gérer les demandes d’association</a>
      </div>

      <div class="mb-3" style="max-width: 300px;">
        <input type="text" id="searchInput" class="form-control" placeholder="Rechercher par Nom ou ID">
      </div>

      <div class="shadow rounded p-2 mb-2" style="min-height: 370px; max-height: 400px; overflow-y: auto; overflow-x: auto; background-color: rgba(255, 255, 255, 0.9); font-size: small; min-width: max-content;">
        <h6 class="mb-2 text-center">Liste de vos talibés</h6>
        <div class="text-center mb-2">
            <span class="badge bg-primary">
                Nombre de talibés : {{ enfants|length }}
            </span>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead class="table-dark sticky-top">
                    <tr>
                        <th>ID Appareil</th>
                        <th>Nom</th>
                        <th>Prénom</th>
                        <th>Date de naissance</th>
                        <th>Provenance</th>
                        <th>Position</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for enfant in enfants %}
                    <tr>
                        <td>{{ enfant.id_esp32 }}</td>
                        <td>{{ enfant.nom }}</td>
                        <td>{{ enfant.prenom }}</td>
                        <td>{{ enfant.date_naissance }}</td>
                        <td>{{ enfant.provenance }}</td>
                        <td><a href="{% url 'suivre_enfant' enfant.id %}">Suivre</a></td>
                        <td class="d-flex flex-wrap gap-1">
                            <a href="{% url 'modifier_enfant' enfant.id %}" class="btn btn-warning btn-sm">Modifier</a>
                            <a href="{% url 'supprimer_enfant' enfant.id %}" class="btn btn-danger btn-sm"
                                onclick="return confirm('Confirmer la suppression de {{ enfant.prenom }} {{ enfant.nom }} ?')">Supprimer</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="text-center">Aucun enfant enregistré pour l’instant.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
      </div>

    </div>
  </div>
</div>
{% endblock %}

